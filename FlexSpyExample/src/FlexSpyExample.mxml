<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
				xmlns:view="view.*"
				layout="vertical" 
				horizontalAlign="center"
				verticalAlign="top"
				creationComplete="onCreationComplete()"
				>
	<mx:Script>
		<![CDATA[
			import com.flexspy.FlexSpy;
			
			import mx.containers.Panel;
			import mx.core.UIComponent;
			import mx.managers.PopUpManager;
			
			import pm.MainPM;
			import pm.TestViewPM;
			[Bindable]
			public var model : MainPM = new MainPM();
			
			private function onCreationComplete() : void{
				FlexSpy.addContextMenuTo( this );
				FlexSpy.addModule(LogViewer);
			}
			
			private function showPopup() : void{
				var popup : UIComponent = PopUpManager.createPopUp(this, Panel, true) as UIComponent;
				var pm : TestViewPM = new TestViewPM("popup", 0xaaaaaa);
				var popupView : TestView = new TestView();
				popupView.model = pm;
				popup.addChild(popupView);
				PopUpManager.centerPopUp(popup);
				FlexSpy.addContextMenuTo(popup);
			}
			
		]]>
	</mx:Script>
	<mx:ViewStack id="mainStack"
				  selectedIndex="{ model.selectedIndex} ">
		<view:TestView model="{ model.model1 }" />
		<view:TestView model="{ model.model2 }" />
		<view:TestView model="{ model.model3 }" />
		
	</mx:ViewStack>
	<mx:HBox>
		<mx:Button label="previous" click="model.previousView()" />
		<mx:Button label="next" click="model.nextView()" />
	</mx:HBox>
	<mx:Button label="show a popoup" click="showPopup()" />
</mx:Application>
