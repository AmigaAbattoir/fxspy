<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%"
		   label="Log"
		   creationComplete="onCreationComplete()">
<mx:Script>
	<![CDATA[
		import com.flexspy.FlexSpy;
		import com.flexspy.event.FlexSpyEvent;
		private function onCreationComplete() : void{
			//register for flexspy events
			FlexSpy.addEventListener(FlexSpyEvent.HIDE, handleFlexSpyEvent);
			FlexSpy.addEventListener(FlexSpyEvent.SHOW, handleFlexSpyEvent);
			FlexSpy.addEventListener(FlexSpyEvent.PROPERTY_SELECTED, handleFlexSpyEvent);
			FlexSpy.addEventListener(FlexSpyEvent.VIEW_ITEM_SELECTED, handleFlexSpyEvent);
		}
		private var currentObject : Object;
		[Bindable]
		private var isFiltered : Boolean;
		
		private function handleFlexSpyEvent(event : FlexSpyEvent) : void{
			if ( event.propertyName != null){
				Log.instance.addLine(event.propertyName, event.propertyValue);
			}
			if ( event.viewItem != null){
				Log.instance.addLine(event.viewItem, "FlexSpy: " + event.type);
				currentObject = event.viewItem;
				if ( isFiltered){
					Log.instance.filterSource(currentObject);
				}
			}
		}
		private function toggleFilter() : void{
			isFiltered = !isFiltered;
			Log.instance.filterSource(isFiltered ? currentObject : null);
		}
	]]>
</mx:Script>
	<mx:HBox>
		<mx:Button label="{isFiltered ? 'all' : 'filter'}" click="toggleFilter()"/>
		<mx:Button label="clear" click="{Log.instance.items.removeAll()}" />
	</mx:HBox>
	<mx:DataGrid dataProvider="{Log.instance.items}" width="100%" height="100%" >
		<mx:columns>
			<mx:DataGridColumn dataField="name" headerText="Item" width="200"/>
			<mx:DataGridColumn dataField="text" headerText="Message" width="600"/>
		</mx:columns>
		</mx:DataGrid>
</mx:VBox>
