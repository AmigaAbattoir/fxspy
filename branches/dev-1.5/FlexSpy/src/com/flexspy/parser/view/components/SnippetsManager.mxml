<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow 
	xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:components="com.flexspy.parser.view.components.*" 
	width="400" 
	height="300"
	creationComplete="createModels()"
	showCloseButton="true"
	title="Snippets Manager"
	close="closeManager()">
	
	<mx:Script>
		<![CDATA[
		
			import com.flexspy.parser.event.SnippetEvent;
			import com.flexspy.parser.model.domain.Snippet;
			import com.flexspy.parser.model.presentation.components.SnippetManagerModifier;
			import com.flexspy.parser.model.FlexTrampModelLocator;
		
			import mx.events.ListEvent;
			import mx.events.TreeEvent;
			import mx.managers.PopUpManager;
		
			[Bindable]
			public var model : SnippetManagerModifier;
			
			private function createModels() : void
			{
				var flexTrampModelLocator: FlexTrampModelLocator = FlexTrampModelLocator.getInstance();
				
				model = new SnippetManagerModifier( flexTrampModelLocator.snippets );
			}
			
			private function closeManager() : void
			{
				PopUpManager.removePopUp( this );	
			}
			
			private function handleItemDoubleClick( event : ListEvent ) : void
			{
				var item : Object = snippetsTree.selectedItem;
				
				if( item is Snippet )
				{
					dispatchSnippetSelectedEvent( Snippet( item ) );
				} 	
			}
			
			private function dispatchSnippetSelectedEvent( snippet : Snippet ) : void
			{
				var event : SnippetEvent = new SnippetEvent( 
						snippet,
						SnippetEvent.SNIPPET_SELECTED );
			
				dispatchEvent( event );		
				
				closeManager();	
			}

		]]>
	</mx:Script>
	
	<components:SnippetsTree
		id="snippetsTree"
		model="{ model }"
		width="100%"
		height="100%"
		doubleClickEnabled="true"
		dragEnabled="true"
		itemDoubleClick="handleItemDoubleClick( event )"/>
	
</mx:TitleWindow>